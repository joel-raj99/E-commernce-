{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///D:/project/E-commernce-/src/app/api/product/route.js"],"sourcesContent":["// \"use server\";\r\n// import { NextResponse } from \"next/server\";\r\n// import  connectDB  from \"@/app/lib/db\";\r\n// import Product from \"@/app/models/ProductModel\";\r\n\r\n// // ðŸŸ¢ CREATE Product\r\n// export async function POST(req) {\r\n//   try {\r\n//     await connectDB();\r\n//     const body = await req.json();\r\n\r\n//     const newProduct = await Product.create(body);\r\n//     return NextResponse.json(\r\n//       { message: \"Product created successfully\", product: newProduct },\r\n//       { status: 201 }\r\n//     );\r\n//   } catch (error) {\r\n//     return NextResponse.json(\r\n//       { message: \"Error creating product\", error: error.message },\r\n//       { status: 500 }\r\n//     );\r\n//   }\r\n// }\r\n\r\n// // ðŸ”µ GET All Products\r\n// export async function GET() {\r\n//   try {\r\n//     await connectDB();\r\n//     const products = await Product.find({});\r\n//     return NextResponse.json(products, { status: 200 });\r\n//   } catch (error) {\r\n//     return NextResponse.json(\r\n//       { message: \"Error fetching products\", error: error.message },\r\n//       { status: 500 }\r\n//     );\r\n//   }\r\n// }\r\n\"use server\";\r\nimport { NextResponse } from \"next/server\";\r\nimport fs from \"fs\";\r\nimport path from \"path\";\r\nimport  connectDB  from \"@/app/lib/db\";\r\nimport Product from \"@/app/models/ProductModel\";\r\n\r\nexport const runtime = \"nodejs\"; // ðŸ”¥ required for file system access\r\n\r\n// ðŸŸ¢ POST â€” Create product with multiple images\r\nexport async function POST(req) {\r\n  try {\r\n    await connectDB();\r\n\r\n    const formData = await req.formData();\r\n\r\n    // Extract all fields\r\n    const name = formData.get(\"name\");\r\n    const price = Number(formData.get(\"price\"));\r\n    const description = formData.get(\"description\");\r\n    const category = formData.get(\"category\");\r\n    const quantity = Number(formData.get(\"quantity\"));\r\n    const power = formData.get(\"power\");\r\n    const usage = formData.get(\"usage\");\r\n    const numberOfSpeeds = Number(formData.get(\"numberOfSpeeds\"));\r\n    const isiCertified = formData.get(\"isiCertified\") === \"true\";\r\n    const warranty = formData.get(\"warranty\");\r\n    const uses = formData.get(\"uses\");\r\n    const bodyMaterial = formData.get(\"bodyMaterial\");\r\n    const numberOfBlades = Number(formData.get(\"numberOfBlades\"));\r\n    const countryOfOrigin = formData.get(\"countryOfOrigin\");\r\n    const voltage = formData.get(\"voltage\");\r\n    const frequency = formData.get(\"frequency\");\r\n    const brandName = formData.get(\"brandName\");\r\n    const modelName = formData.get(\"modelName\");\r\n    const material = formData.get(\"material\");\r\n\r\n    // Handle multiple file uploads\r\n    const files = formData.getAll(\"images\");\r\n    const uploadDir = path.join(process.cwd(), \"public/uploads\");\r\n\r\n    if (!fs.existsSync(uploadDir)) {\r\n      fs.mkdirSync(uploadDir, { recursive: true });\r\n    }\r\n\r\n    const imagePaths = [];\r\n    for (const file of files) {\r\n      const buffer = Buffer.from(await file.arrayBuffer());\r\n      const filename = `${Date.now()}-${file.name.replace(/\\s+/g, \"_\")}`;\r\n      const filePath = path.join(uploadDir, filename);\r\n      fs.writeFileSync(filePath, buffer);\r\n      imagePaths.push(`/uploads/${filename}`);\r\n    }\r\n\r\n    const newProduct = await Product.create({\r\n      name,\r\n      price,\r\n      description,\r\n      images: imagePaths,\r\n      category,\r\n      quantity,\r\n      power,\r\n      usage,\r\n      numberOfSpeeds,\r\n      isiCertified,\r\n      warranty,\r\n      uses,\r\n      bodyMaterial,\r\n      numberOfBlades,\r\n      countryOfOrigin,\r\n      voltage,\r\n      frequency,\r\n      brandName,\r\n      modelName,\r\n      material,\r\n    });\r\n\r\n    return NextResponse.json(\r\n      { message: \"Product created successfully\", product: newProduct },\r\n      { status: 201 }\r\n    );\r\n  } catch (error) {\r\n    console.error(\"Error creating product:\", error);\r\n    return NextResponse.json(\r\n      { message: \"Error creating product\", error: error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// ðŸ”µ GET â€” Fetch all products\r\nexport async function GET() {\r\n  try {\r\n    await connectDB();\r\n    const products = await Product.find({});\r\n    return NextResponse.json(products, { status: 200 });\r\n  } catch (error) {\r\n    return NextResponse.json(\r\n      { message: \"Error fetching products\", error: error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,gBAAgB;AAChB,8CAA8C;AAC9C,0CAA0C;AAC1C,mDAAmD;AAEnD,uBAAuB;AACvB,oCAAoC;AACpC,UAAU;AACV,yBAAyB;AACzB,qCAAqC;AAErC,qDAAqD;AACrD,gCAAgC;AAChC,0EAA0E;AAC1E,wBAAwB;AACxB,SAAS;AACT,sBAAsB;AACtB,gCAAgC;AAChC,qEAAqE;AACrE,wBAAwB;AACxB,SAAS;AACT,MAAM;AACN,IAAI;AAEJ,yBAAyB;AACzB,gCAAgC;AAChC,UAAU;AACV,yBAAyB;AACzB,+CAA+C;AAC/C,2DAA2D;AAC3D,sBAAsB;AACtB,gCAAgC;AAChC,sEAAsE;AACtE,wBAAwB;AACxB,SAAS;AACT,MAAM;AACN,IAAI","debugId":null}}]
}